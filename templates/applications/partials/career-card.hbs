<article class="draggable career item game-sheet" data-item-id="{{item._id}}">
	<div class="face front active">
		<div class="header">
			{{#if @root.editable}}
				<a class="name" data-action="editItem" data-tooltip="{{localize 'ACTOR.ACTIONS.editItem'}}">
					{{item.name}}
				</a>
			{{else}}
				<span class="name">
					{{item.name}}
				</span>
			{{/if}}

			<div class="race-restrictions">
				{{#if item.system.advanced}}
					{{localize "CAREER.SHEET.advancedCareer"}}
				{{else}}
					{{localize "CAREER.SHEET.basicCareer"}}
				{{/if}}
				:
				{{#each item.system.raceRestrictions}}
					{{#if (and (eq @first true) (eq @last true) (ne this "any"))}}
						{{localize "CAREER.SHEET.oneRaceOnly" race=(localize (concat "RACE." this))}}
					{{else}}
						{{localize (concat "RACE." this)}}{{#unless @last}}, {{/unless}}
					{{/if}}
				{{/each}}
			</div>

			<div class="traits">
				{{item.system.traits}}
			</div>
		</div>

		<div class="details">
			<div class="career-aptitudes">
				<div class="primary-characteristics">
					<div class="career-aptitudes-title">
						{{localize "CAREER.SHEET.primaryCharacteristics"}}
					</div>

					<div class="career-aptitudes-content">
						{{#each item.system.primaryCharacteristics}}
							{{localize (lookup (lookup @root.characteristics this) "name")}}{{#unless @last}},{{/unless}}
						{{/each}}
					</div>
				</div>

				<div class="career-skills">
					<div class="career-aptitudes-title">
						{{localize "CAREER.SHEET.careerSkills"}}
					</div>

					<div class="career-aptitudes-content">
						{{item.system.careerSkills}}
					</div>
				</div>

				<div class="starting-stance">
					{{#for (multiply item.system.startingStance.conservativeSegments -1) (increment item.system.startingStance.recklessSegments 1) 1}}
						<img class="stance-{{#if (lt this 0)}}conservative{{else if (gt this 0)}}reckless{{else}}neutral{{/if}}"
							 src="systems/wfrp3e/assets/images/stance-{{#if (lt this 0)}}conservative{{else if (gt this 0)}}reckless{{else}}neutral{{/if}}.webp" height="27" />
					{{/for}}
				</div>
			</div>

			<div class="advance-options">
				<span class="header">
					{{localize "CAREER.SHEET.advances"}}
				</span>

				<div class="advance-option action">
					<div class="title">
						{{localize "CAREER.SHEET.action"}}
					</div>

					<div class="content">
						{{item.system.advanceOptions.action}}
					</div>
				</div>

				<div class="advance-option talent">
					<div class="title">
						{{localize "CAREER.SHEET.talent"}}
					</div>

					<div class="content">
						{{item.system.advanceOptions.talent}}
					</div>
				</div>

				<div class="advance-option skill">
					<div class="title">
						{{localize "CAREER.SHEET.skill"}}
					</div>

					<div class="content">
						{{item.system.advanceOptions.skill}}
					</div>
				</div>

				<div class="advance-option fortune">
					<div class="title">
						{{localize "CAREER.SHEET.fortune"}}
					</div>

					<div class="content">
						{{item.system.advanceOptions.fortune}}
					</div>
				</div>

				<div class="advance-option conservative">
					<div class="title">
						{{localize "CAREER.SHEET.conservative"}}
					</div>

					<div class="content">
						{{item.system.advanceOptions.conservative}}
					</div>
				</div>

				<div class="advance-option reckless">
					<div class="title">
						{{localize "CAREER.SHEET.reckless"}}
					</div>

					<div class="content">
						{{item.system.advanceOptions.reckless}}
					</div>
				</div>

				<div class="advance-option wound">
					<div class="title">
						{{localize "CAREER.SHEET.wound"}}
					</div>

					<div class="content">
						{{item.system.advanceOptions.wound}}
					</div>
				</div>
			</div>
		</div>

		<div class="socket-container">
			{{#each system.sockets as |socket sckt|}}
				{{#if socket.item}}
					{{#with (fromUuid socket.item) as |socketedItem|}}
						<a class="socket {{socketedItem.system.type}}"
						   data-item-id="{{socketedItem._id}}"
						   data-action="editItem"
						   data-tooltip="{{localize 'ACTOR.ACTIONS.editItem'}}">
							{{socketedItem.name}}
							<span class="fa-solid fa-pen-to-square"></span>
						</a>
					{{/with}}
				{{else}}
					<div class="socket {{socket.type}}">
						{{localize (lookup @root.types socket.type)}}
					</div>
				{{/if}}
			{{/each}}
		</div>

		<img class="art" src="{{item.img}}" />
	</div>

	<div class="face back">
		<div class="header">
			<span class="name">{{item.name}}</span>

			<div class="race-restrictions">
				{{#if item.system.advanced}}
					{{localize "CAREER.SHEET.advancedCareer"}}
				{{else}}
					{{localize "CAREER.SHEET.basicCareer"}}
				{{/if}}
				:
				{{#each item.system.raceRestrictions}}
					{{#if (and (eq @first true) (eq @last true) (ne this "any"))}}
						{{localize "CAREER.SHEET.oneRaceOnly" race=(localize (concat "RACE." this))}}
					{{else}}
						{{localize (concat "RACE." (capitalize this))}}{{#unless @last}}, {{/unless}}
					{{/if}}
				{{/each}}
			</div>

			<div class="traits">
				{{item.system.summary}}
			</div>
		</div>

		<div class="description">
			{{{lookup @root.enrichment item.uuid }}}
		</div>
	</div>

	<div class="bottom-line">
		<div>
			<a data-action="flip" data-tooltip="{{localize 'ACTOR.ACTIONS.flip'}}">
				<span class="fas fa-undo"></span>
			</a>
		</div>

		{{#if @root.editable}}
			<div class="form-group slim stacked">
				<label>{{localize "CAREER.FIELDS.current.label"}}</label>

				<input name="system.current"
					   type="radio"
					   {{checked item.system.current}}
					   {{#unless @root.editable}}disabled{{/unless}} />
			</div>
		{{/if}}

		<div>
			{{#if @root.editable}}
					<a data-action="editItem" data-tooltip="{{localize 'ACTOR.ACTIONS.editItem'}}">
						<span class="fas fa-pen-to-square"></span>
					</a>

					<a data-action="deleteItem" data-tooltip="{{localize 'Delete'}}">
						<span class="fas fa-trash"></span>
					</a>
			{{/if}}
		</div>
	</div>
</article>
